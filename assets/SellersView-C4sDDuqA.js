import{S as O,d as z,j as k,e,w as l,a as t,b as n,F as E,m as N,o as d,t as x,f as h,q as B,z as F,c as b,A as H,r as V,i as I,C as D,p as q,_ as U,B as T,x as Q,u as W,y as X,l as Z,g as ee,D as te}from"./index-er5vummF.js";function G(y){return y===O.active?"primary":"secondary"}const le={class:"w-100"},ae={"data-testid":"sellerList__items"},se=["data-testid"],oe=["data-testid"],ne={class:"text-center"},ie=z({__name:"SellersList",props:{items:{type:Array,default:()=>[]}},setup(y){return(v,u)=>{const S=t("v-chip"),m=t("v-btn"),s=t("v-icon"),_=t("v-list-item-title"),$=t("v-list-item"),C=t("v-list"),w=t("v-menu"),g=t("v-table");return d(),k("div",le,[e(g,{"data-testid":"sellerList"},{default:l(()=>[u[0]||(u[0]=n("thead",{"data-testid":"sellerList__headers"},[n("tr",null,[n("th",{"data-testid":"sellerList__headers--name",class:"text-left"},"Nombre"),n("th",{"data-testid":"sellerList__headers--status",class:"text-left"},"Estatus"),n("th",{"data-testid":"sellerList__headers--observations",class:"text-left"},"Observaciones"),n("th",{"data-testid":"sellerList__headers--actions",class:"text-center"},"Acciones")])],-1)),n("tbody",ae,[(d(!0),k(E,null,N(y.items,a=>(d(),k("tr",{"data-testid":`sellerList__items--${a.id}`,key:`job-${a.id}`},[n("td",{"data-testid":`sellerList__items--${a.id}-title`},x(a.name),9,oe),n("td",null,[e(S,{color:h(G)(a.status)},{default:l(()=>[B(x(a.status),1)]),_:2},1032,["color"])]),n("td",null,x(a.observations),1),n("td",ne,[e(m,{flat:"",variant:"outlined",size:"x-small",icon:"edit",color:"primary",onClick:i=>v.$emit("openDialog",a)},null,8,["onClick"]),e(w,null,{activator:l(({props:i})=>[e(m,H({icon:"more_vert",variant:"text",ref_for:!0},i,{size:"x-small"}),null,16)]),default:l(()=>[e(C,{class:"py-1",density:"compact",slim:""},{default:l(()=>[(d(!0),k(E,null,N(h(F),(i,p)=>(d(),b($,{key:p,value:p,onClick:r=>v.$emit("selectedAction",{action:i.action,seller:a})},{prepend:l(()=>[e(s,{icon:i.icon,color:i.color},null,8,["icon","color"])]),default:l(()=>[e(_,null,{default:l(()=>[B(x(i.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:2},1024)]),_:2},1024)])],8,se))),128))])]),_:1})])}}}),re={class:"w-100"},ce={class:"text-h5"},de={class:"d-flex flex-column"},ue={class:"d-flex align-center justify-space-between w-100"},ve={class:"d-flex ga-2"},_e=z({__name:"SellersCards",props:{items:{type:Array,default:()=>[]}},setup(y){return(v,u)=>{const S=t("v-divider"),m=t("v-chip"),s=t("v-card-text"),_=t("v-btn"),$=t("v-card-actions"),C=t("v-card"),w=t("v-col"),g=t("v-row");return d(),k("div",re,[e(g,null,{default:l(()=>[(d(!0),k(E,null,N(y.items,a=>(d(),b(w,{cols:"12",sm:"6",md:"6",lg:"3",key:`itemCard-${a.id}`},{default:l(()=>[e(C,{class:"item-card"},{title:l(()=>[n("span",ce,x(a.name),1)]),default:l(()=>[e(S),e(s,{class:"item-card__content"},{default:l(()=>[n("div",de,[n("span",null,x(a.observations),1),e(m,{color:h(G)(a.status),class:"mt-2"},{default:l(()=>[B(x(a.status),1)]),_:2},1032,["color"])])]),_:2},1024),e($,null,{default:l(()=>[n("div",ue,[n("div",ve,[(d(!0),k(E,null,N(h(F),(i,p)=>(d(),b(_,{flat:"",variant:"outlined",size:"x-small",icon:i.icon,color:i.color,key:`action-${p}`,onClick:r=>v.$emit("selectedAction",{action:i.action,seller:a})},null,8,["icon","color","onClick"]))),128))]),e(_,{flat:"",variant:"outlined",size:"x-small",icon:"edit",color:"primary",onClick:i=>v.$emit("openDialog",a)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])}}}),me={class:"d-flex align-center"},pe=z({__name:"EditSeller",props:{isActive:{type:Boolean,default:!1},seller:{type:[Object,null],default:null}},emits:["closeDialog","saved"],setup(y,{emit:v}){var C,w,g,a,i;const u=y,S=v,m=V(!1),s=V({id:((C=u.seller)==null?void 0:C.id)||"0",name:((w=u.seller)==null?void 0:w.name)||"",identification:((g=u.seller)==null?void 0:g.identification)||"",status:((a=u.seller)==null?void 0:a.status)||O.active,observations:((i=u.seller)==null?void 0:i.observations)||""}),_=I(()=>u.seller===null?{action:D.add,title:"Agregar",icon:"add"}:{action:D.edit,title:"Editar",icon:"edit"}),$=async()=>{try{m.value=!0,_.value.action===D.edit&&await T.put(s.value.id,s.value),_.value.action===D.add&&await T.post(s.value),S("saved")}catch(p){console.error(p)}finally{m.value=!1}};return(p,r)=>{const j=t("v-icon"),o=t("v-divider"),c=t("v-text-field"),f=t("v-col"),L=t("v-textarea"),J=t("v-switch"),P=t("v-row"),R=t("v-card-text"),K=t("v-card-actions"),M=t("v-card"),Y=t("v-dialog");return d(),b(Y,{"max-width":"500","model-value":y.isActive,"content-class":"global-dialog",persistent:"",transition:"dialog-top-transition"},{default:l(()=>[e(M,null,{prepend:l(()=>[e(j,{color:"secondary",icon:_.value.icon},null,8,["icon"])]),title:l(()=>[B(x(_.value.title)+" vendedor",1)]),default:l(()=>[e(o),e(R,null,{default:l(()=>[e(P,{dense:""},{default:l(()=>[e(f,{cols:"12"},{default:l(()=>[e(c,{variant:"outlined",label:"Nombre",required:"",modelValue:s.value.name,"onUpdate:modelValue":r[0]||(r[0]=A=>s.value.name=A)},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:l(()=>[e(L,{"no-resize":"",variant:"outlined",label:"Observaciones",modelValue:s.value.observations,"onUpdate:modelValue":r[1]||(r[1]=A=>s.value.observations=A)},null,8,["modelValue"])]),_:1}),_.value.action===h(D).edit?(d(),b(f,{key:0,cols:"12"},{default:l(()=>[n("div",me,[r[5]||(r[5]=n("span",{class:"mr-2"},"Estatus",-1)),e(J,{color:"primary","false-value":h(O).inactive,"true-value":h(O).active,modelValue:s.value.status,"onUpdate:modelValue":r[2]||(r[2]=A=>s.value.status=A),"hide-details":""},null,8,["false-value","true-value","modelValue"])])]),_:1})):q("",!0)]),_:1})]),_:1}),e(K,null,{default:l(()=>[e(U,{color:"grey-darken-1",text:"Cancelar",onClick:r[3]||(r[3]=A=>p.$emit("closeDialog"))}),e(U,{onClick:r[4]||(r[4]=A=>$()),text:"Guardar",disabled:m.value,loading:m.value},null,8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),fe={class:"view-layout"},ye={class:"d-flex justify-end mb-4"},be=z({__name:"SellersView",setup(y){const v=V([]),u=V(!1),S=V(null),m=V(new Date().getTime()),s=V(!1),_=Q(),$=I(()=>_.dialog),w=W(ee).smaller("lg"),g=async()=>{try{s.value=!0;const o=await T.get();return o!=null&&o.length?o:[]}catch(o){return console.error(o),[]}finally{s.value=!1}},a=o=>{u.value=!0,S.value=o,m.value=new Date().getTime()},i=async()=>{v.value=[],u.value=!1,m.value=new Date().getTime(),v.value=await g()},p=async o=>{try{s.value=!0,await T.delete(o.id)}catch(c){console.error(c)}finally{s.value=!1}},r=async o=>{const{action:c,seller:f}=o;try{if(s.value=!0,c===D.delete&&j(f),c===D.toggleStatus){const L=f.status===O.active?O.inactive:O.active;await T.put(f.id,{...f,status:L}),i()}}catch(L){console.error(L)}finally{s.value=!1}},j=o=>{_.activeDialog({...$.value,title:"Confirmación",message:`<div class="d-flex ">
      ¿Deseas eliminar este vendedor? Esta acción no se puede deshacer.
    </div>`,okButton:"Acpetar",type:te.confirm,params:JSON.stringify({deleteSeller:!0,seller:o})})};return X($,async o=>{const c=o!=null&&o.data?JSON.parse(o.data):{};c.deleteSeller&&(await p(c.seller),_.closeDialog(),await i())}),Z(async()=>{v.value=await g()}),(o,c)=>{const f=t("v-progress-linear");return d(),k("div",fe,[c[2]||(c[2]=n("div",{class:"text-h4"},"Vendedores",-1)),(d(),b(pe,{key:m.value,isActive:u.value,seller:S.value,onCloseDialog:c[0]||(c[0]=L=>u.value=!u.value),onSaved:i},null,8,["isActive","seller"])),n("div",ye,[e(U,{text:"Agregar","prepend-icon":"add",onClick:c[1]||(c[1]=L=>a(null)),disabled:s.value},null,8,["disabled"])]),s.value?(d(),b(f,{key:0,color:"secondary",indeterminate:""})):q("",!0),h(w)?(d(),b(_e,{key:1,items:v.value,onOpenDialog:a,onSelectedAction:r},null,8,["items"])):(d(),b(ie,{key:2,items:v.value,onOpenDialog:a,onSelectedAction:r},null,8,["items"]))])}}});export{be as default};
